\subsection{Sicherheitsanalysen im Internet of Things}
\label{sec:sota_sa}
	
	\begin{itemize}
		\item Sicherheitskonzepte erklären, Sicherheitsziele (CIA, Auth, Non-rep, etc.)
		\item Erwähnung von OWASP-Projekt und Guidelines
		\item \gls{cvss} Bewertungsschema erklären
		\item Threat Model
		\item Securityl Goals
	\end{itemize}
	Kurze Einfühung, dann gleich Überleitung zum CVSS.
	
	\cite{CVSSspec}
	Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.
	
	Integrity refers to the trustworthiness and veracity of information.
	
	Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of an impacted component.
	
\subsubsection{Common Vulnerability Scoring System (CVSS)}
\label{sec:sota_sa_cvss}
    \todo[color=cyan]{System kurz erlöären}
    \noindent Der Base Score besteht aus zwei Subscores, Exploitability Score und Impact Score, welche wie folgt in Listing \ref{eq:cvss_basescore} verrechnet werden:
    \begin{lstlisting}[caption={Berechnung des BaseScore \cite{CVSSspec}},label=eq:cvss_basescore,captionpos=b,mathescape=true]
if (ImpactSubScore <= 0)
    BaseScore = 0
else
if(Scope == Unchanged)
    BaseScore = RoundUp(Minimum [(Impact + Exploitability), 10])
if(Scope == Changed)
    BaseScore = RoundUp(
      Minimum [1.08 $\mathsf{\times}$ (Impact + Exploitability), 10])
    \end{lstlisting}
    
    \noindent Ziel des Base Scores ist es wesentliche Charakteristiken, die in verschiedenen Umgebungenen und Zeitpunkten konstant sind, einer Schwachstelle zu repräsentieren. 
    Der Score liegt zwischen dem Wert 0.0 und 10.0, wobei 0 das kleinste Risiko repräsentiert und 10 das Größte\cite{CVSSspec}. 
    Die \fref{tab:cvss_severity} zeigt die Zuordnung der verschiedenen Scores zu Risikograden. 
    \begin{table}[H]
        \centering
        \begin{tabular}{|m{0.2\textwidth}|m{0.2\textwidth}|}
        \hline
        \textbf{Rating}   & \textbf{\gls{cvss} Score}   \\ \hline
        None              & 0.0                         \\ \hline
        Low               & 0.1 - 3.9                   \\ \hline
        Medium            & 4.0 - 6.9                   \\ \hline
        High              & 7.0 - 8.9                   \\ \hline
        Critical          & 9.0 - 10.0                  \\ \hline
        \end{tabular}
        \caption{Skala des Ausmaßes\cite{CVSSspec}}
        \label{tab:cvss_severity}
    \end{table}
    \noindent Der Exploitability Score wird aus den Exploitablility Metrics berechnet(vgl. Listing \ref{eq:cvss_explscore}) und modelliert die Charakteristiken der anfälligen Komponente. 
    \smallskip\\
    \begin{lstlisting}[caption={Berechnung des Exploitability Score \cite{CVSSspec}},label=eq:cvss_explscore,captionpos=b,mathescape=true]
Exploitability = 8.22 $\mathsf{\times}$ AttackVector $\mathsf{\times}$ AttackComplexity 
  $\mathsf{\times}$ PrivilegeRequired $\mathsf{\times}$ UserInteraction
    \end{lstlisting}
    \noindent Folgende Variablen werden dabei verrechnet:
    \begin{description}[itemsep=0.7em,align=left,labelindent=0pt,leftmargin=0pt]
        \item [Attack Vector:] Beschreibt den Kontext, in der Ausnutzung der Schwachstelle möglich ist.
            Der Wert, der in den Exploitability Score einfließt ist größert, je entfernter (im technischen Sinne) ein Angreifer sein kann, um einen Angriff zu starten.
            \begin{description}[noitemsep,align=left,labelindent=0.7cm,leftmargin=0.7cm]
                \item [Network:] Schwachstelle ist über Netzerkzugriff ausnutzbar, auch, wenn der Zugriff ein oder mehrere Hops via Layer 3
                \footnote{nach dem OSI-Modell}
                entfernt ist. 
                \item [Adjacent:] Schwachstelle ist über Netzerkzugriff ausnutzbar, aber der Angriff ist auf das selbse physische oder logische Netzwerk eingeschränkt und kann nicht über eine Layer 3 Grenze (bspw. einem Router) ausgeführt werden.
                \item [Local:] Ein lokaler Zugriff ist nötig, um die Schwachstelle ausnutzen zu können und die Komponente ist nicht an den Netzwerkstack gebunden.
                Der Angriff funktioniert über lesende/schreibende/ausführende Zugriffe und kann voraussetzen, dass der Angreifer entweder in das System eingeloggt ist und/oder eine Nutzerinteraktion tätigt, bei der eine bösartige Datei ausgefürt wird.
                \item [Physical:] Der Angreifer muss in der Lage sein die anfällige Komponente über eine bestimmte Zeit physisch zu bedienen oder zu manipulieren.
            \end{description}
        \item [Attack Complexity:] Beschreibt die Bedingungen außerhalb der Kontrolle des Angreifers, die herrschen müssen, um die Schwachstelle auszunutzen (bspw. bestimmte Systemkonfiguration).
            \begin{description}[noitemsep,align=left,labelindent=0.7cm,leftmargin=0.7cm]
                \item [Low:] Spezielle Zugriffsbedingungen oder ähnliches existieren nicht.
                Ein Angreifer kann wiederkehrenden Erfolg gegen die Komponente erzielen.
                \item [High:] Ein erfolgreicher Angriff hängt von Zuständen außerhalb des Einflusses des Angreifers ab und kann voraussetzen, dass der Angreifer im Voraus einiges an Aufwand investieren muss, um diese Zuständer herzustellen.
            \end{description}
        \item [Privileges Required:] Beschreibt das Level an Privilegien, die ein Angreifer besitzen muss, um eine Schwachstelle ausnutzen können.
            \begin{description}[noitemsep,align=left,labelindent=0.7cm,leftmargin=0.7cm]
                \item [None:] Der Angreifer ist vor dem Angriff nicht autorisiert und benötigt daher keinen Zugriff auf Einstellungen oder Dateien, um den Angriff ausführen zu können.
                \item [Low:] Der Angreifer ist mit grundlegenden Nutzerrechten autorisisiert.
                \item [High:] Der Angreifer ist mit erweiterten oder administrativen Rechten autorisiert und kann komponentenweite Einstellungen und Dateien ändern.
            \end{description}
        \item [User Interaction:] Beschreibt die Voraussetzung, ob ein Angreifer einen erfolgreichen Angriff ohne weitere Beteiligung von anderen Nutzern ausführen kann oder ob ein Nutzer in irgendeiner Weise mitwirken muss.
            \begin{description}[noitemsep,align=left,labelindent=0.7cm,leftmargin=0.7cm]
                \item [None:] Ein Angriff kann ohne Interaktion eines anderen Nutzers erfolgreich sein.
                \item [Required:] Erfolgreiches Ausnutzen einer Schwachstelle ist nur möglich, wenn ein anderer Nutzer eine oder mehrere bestimmte Aktionen ausführt.
            \end{description}
    \end{description}
    
    \noindent Der Impact Score wird aus den Impact Metrics berechnet (vgl. Listing \ref{eq:cvss_impscore} und beschreiben die Eigenschaften des betroffenen Komponenten. 
    Sollte ein erfolgreich ausgeführter Angriff auch andere Komponenten beeinflussen, so wird die Komponente mit dem worst-case, also der höchsten Einstufung gewertet.
    \smallskip\\
    \begin{lstlisting}[caption={Berechnung des Impact Score \cite{CVSSspec}},label=eq:cvss_impscore,captionpos=b,mathescape=true]
$\mathsf{ISC_{Base}}$ = 1 - [(1 - $\mathsf{Impact_{Conf}}$) $\mathsf{\times}$ (1 - $\mathsf{Impact_{Integ}}$) $\mathsf{\times}$ (1-$\mathsf{Impact_{Avail}}$)]
if (Scope == Unchanged)
    Impact = 6.42 $\mathsf{\times}$ $\mathsf{ISC_{Base}}$
if (Scope == Changed)
    Impact = 7.52 $\mathsf{\times}$ [$\mathsf{ISC_{Base}}$ - 0.029] - 3.25 $\mathsf{\times}$ [$\mathsf{ISC_{Base}}$ - 0.02]$\mathsf{^{15}}$
    \end{lstlisting}
    \begin{description}[itemsep=0.7em,align=left,labelindent=0pt,leftmargin=0pt]
        \item [Confidentiality:] Ausmaß auf die Vertraulichkeit der Informationsressourcen, die von einer Softwarekomponente verwaltet werden, welche durch das Ausnutzen einer Schwachstelle komprommittiert wurde.
            \begin{description}[noitemsep,align=left,labelindent=0.7cm,leftmargin=0.7cm]
                \item [None:] Kein Verlust der Vertraulichkeit.
                \item [Low:] Der Angreifer erlangt eingeschränkt Zugriff auf Informationen, hat aber keine Kontrolle darüber, welcher Informationen er erlangt.
                    Oder: Die Preisgabe der Informationen verursacht keinen direkten, schweren Verlust bei der betroffenen Konponente.
                \item [High:] Die Vertraulichkeit ist nicht mehr gegeben.
            \end{description}
        \item [Integrity:] Ausmaß auf die Integrität der Informationsressourcen, die von einer Softwarekomponente verwaltet werden, welche durch das Ausnutzen einer Schwachstelle komprommittiert wurde.
            \begin{description}[noitemsep,align=left,labelindent=0.7cm,leftmargin=0.7cm]
                \item [None:] Kein Verlust der Integrität.
                \item [Low:] Änderung von Daten durch einen Angreifer ist möglich, aber der Angreifer selbst hat keine Kontrolle über die Konsequenz seiner Modifikation oder das Maß der Modifikation ist eingeschränkt.
                \item [High:] Verlust jeglicher Integrität.
                    Der Angreifer kann alle Daten, die durch die Komponente geschützt oder kontrolliert werden modifizieren.
            \end{description}
        \item [Availability:] Ausmaß auf die Verfügbarkeit der Informationsressourcen, die von einer Softwarekomponente verwaltet werden, welche durch das Ausnutzen einer Schwachstelle komprommittiert wurde.
            Damit ist der Verlust der Verfügbarkeit der betroffenen Komponente (wie ein Webservice, eine Datenbank, etc.) selbst gemeint.
            \begin{description}[noitemsep,align=left,labelindent=0.7cm,leftmargin=0.7cm]
                \item [None:] Kein Verlust der Verfügbarkeit
                \item [Low:] Reduzierte Leistung oder Unterbrechungen in der Verfügbarkeit der Ressource.
                \item [High:] Kompletter Verlust der Verfügbarkeit, was dazu führt, dass ein Angreifer den Zugriff auf Ressourcen innerhalb der betroffenen Komponente verhindern kann.
            \end{description}
    \end{description}
    
    \begin{description}[itemsep=0.7em,align=left,labelindent=0pt,leftmargin=0pt]
        \item [Scope:] Beeinflusst ein erfolgreicher Angriff mindestens eine andere Komponente außer die Anfällige?
            \begin{description}[noitemsep,align=left,labelindent=0.7cm,leftmargin=0.7cm]
                \item [Unchanged:] Eine ausgenutzte Schwachstelle beeinflusst nur Ressourcen, die von der gleichen Authorität verwaltet werden - anfällige und die betroffene Komponenten sind also identisch.
                \item [Changed:] Eine ausgenutzte Schwachstelle kann Ressourcen außerhalb der Komponente beeinflussen - anfällige und die betroffene Komponenten sind also nicht identisch.
            \end{description}
    \end{description}
    
    \noindent Es existieren Erweiterungen des Base Scores, der Temporal Score und Environmental Score. 
    Diese beiden Werte werden in dieser Arbeit nicht verwendet. 
    Für die genauen Werte, die für die Berechnungen verwendet werden, wird auf \cite{CVSSspec} verwiesen.\todo[color=cyan]{Anhang?}
    